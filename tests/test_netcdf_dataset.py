import os
import torch
from nowcasting_dataset.dataset.datasets import NetCDFDataset, worker_init_fn, subselect_data
from nowcasting_dataset.consts import (
    SATELLITE_X_COORDS,
    SATELLITE_Y_COORDS,
    SATELLITE_DATA,
    NWP_DATA,
    SATELLITE_DATETIME_INDEX,
    NWP_TARGET_TIME,
    NWP_Y_COORDS,
    NWP_X_COORDS,
    PV_YIELD,
    GSP_YIELD,
)
from nowcasting_dataset.dataset import example
import plotly.graph_objects as go
import plotly
import pandas as pd
import pytest
import tempfile
from pathlib import Path
import numpy as np
import xarray as xr
import datetime


def test_subselect_date():
    # Random example taken from testing. but data randomized
    sat_data = xr.DataArray.from_dict(
        {
            "dims": ("example", "time", "sat_y", "sat_x", "sat_variable"),
            "attrs": {},
            "data": np.random.random((32, 19, 64, 64, 12)),
            "dtype": "float32",
            "shape": (32, 19, 64, 64, 12),
            "coords": {
                "example": {
                    "dims": ("example",),
                    "attrs": {},
                    "dtype": "int32",
                    "shape": (32,),
                    "data": list(range(32)),
                },
                "init_time": {
                    "dims": ("example",),
                    "attrs": {
                        "long_name": "initial time of forecast",
                        "standard_name": "forecast_reference_time",
                    },
                    "dtype": "int32",
                    "shape": (32,),
                    "data": list(range(32)),
                },
                "sat_variable": {
                    "dims": ("sat_variable",),
                    "attrs": {},
                    "dtype": "object",
                    "shape": (12,),
                    "data": ["o", "c", "f", "i", "s", "co", "ol", "!", ":", ")", "IR_016", "HRV"],
                },
                "sat_x": {
                    "dims": ("sat_x",),
                    "attrs": {},
                    "dtype": "int32",
                    "shape": (64,),
                    "data": list(range(64)),
                },
                "sat_y": {
                    "dims": ("sat_y",),
                    "attrs": {},
                    "dtype": "int32",
                    "shape": (64,),
                    "data": list(range(64)),
                },
                "time": {
                    "dims": ("time",),
                    "attrs": {},
                    "dtype": "int64",
                    "shape": (19,),
                    "data": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],
                },
            },
            "name": None,
        }
    )
    date_time = xr.DataArray.from_dict(
        {
            "dims": ("example", "time"),
            "attrs": {},
            "data": [
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
            ],
            "coords": {
                "example": {
                    "dims": ("example",),
                    "attrs": {},
                    "data": list(range(32)),
                },
                "init_time": {
                    "dims": ("example",),
                    "attrs": {
                        "long_name": "initial time of forecast",
                        "standard_name": "forecast_reference_time",
                    },
                    "data": list(range(32)),
                },
                "time": {
                    "dims": ("time",),
                    "attrs": {},
                    "data": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],
                },
            },
            "name": "sat_time_coords",
        }
    )
    nwp_time = xr.DataArray.from_dict(
        {
            "dims": ("example", "time"),
            "attrs": {
                "long_name": "time since forecast_reference_time",
                "standard_name": "forecast_period",
            },
            "data": [
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
                [
                    datetime.datetime(2019, 3, 26, 17, 0),
                    datetime.datetime(2019, 3, 26, 17, 5),
                    datetime.datetime(2019, 3, 26, 17, 10),
                    datetime.datetime(2019, 3, 26, 17, 15),
                    datetime.datetime(2019, 3, 26, 17, 20),
                    datetime.datetime(2019, 3, 26, 17, 25),
                    datetime.datetime(2019, 3, 26, 17, 30),
                    datetime.datetime(2019, 3, 26, 17, 35),
                    datetime.datetime(2019, 3, 26, 17, 40),
                    datetime.datetime(2019, 3, 26, 17, 45),
                    datetime.datetime(2019, 3, 26, 17, 50),
                    datetime.datetime(2019, 3, 26, 17, 55),
                    datetime.datetime(2019, 3, 26, 18, 0),
                    datetime.datetime(2019, 3, 26, 18, 5),
                    datetime.datetime(2019, 3, 26, 18, 10),
                    datetime.datetime(2019, 3, 26, 18, 15),
                    datetime.datetime(2019, 3, 26, 18, 20),
                    datetime.datetime(2019, 3, 26, 18, 25),
                    datetime.datetime(2019, 3, 26, 18, 30),
                ],
                [
                    datetime.datetime(2019, 4, 1, 11, 0),
                    datetime.datetime(2019, 4, 1, 11, 5),
                    datetime.datetime(2019, 4, 1, 11, 10),
                    datetime.datetime(2019, 4, 1, 11, 15),
                    datetime.datetime(2019, 4, 1, 11, 20),
                    datetime.datetime(2019, 4, 1, 11, 25),
                    datetime.datetime(2019, 4, 1, 11, 30),
                    datetime.datetime(2019, 4, 1, 11, 35),
                    datetime.datetime(2019, 4, 1, 11, 40),
                    datetime.datetime(2019, 4, 1, 11, 45),
                    datetime.datetime(2019, 4, 1, 11, 50),
                    datetime.datetime(2019, 4, 1, 11, 55),
                    datetime.datetime(2019, 4, 1, 12, 0),
                    datetime.datetime(2019, 4, 1, 12, 5),
                    datetime.datetime(2019, 4, 1, 12, 10),
                    datetime.datetime(2019, 4, 1, 12, 15),
                    datetime.datetime(2019, 4, 1, 12, 20),
                    datetime.datetime(2019, 4, 1, 12, 25),
                    datetime.datetime(2019, 4, 1, 12, 30),
                ],
                [
                    datetime.datetime(2019, 5, 13, 4, 0),
                    datetime.datetime(2019, 5, 13, 4, 5),
                    datetime.datetime(2019, 5, 13, 4, 10),
                    datetime.datetime(2019, 5, 13, 4, 15),
                    datetime.datetime(2019, 5, 13, 4, 20),
                    datetime.datetime(2019, 5, 13, 4, 25),
                    datetime.datetime(2019, 5, 13, 4, 30),
                    datetime.datetime(2019, 5, 13, 4, 35),
                    datetime.datetime(2019, 5, 13, 4, 40),
                    datetime.datetime(2019, 5, 13, 4, 45),
                    datetime.datetime(2019, 5, 13, 4, 50),
                    datetime.datetime(2019, 5, 13, 4, 55),
                    datetime.datetime(2019, 5, 13, 5, 0),
                    datetime.datetime(2019, 5, 13, 5, 5),
                    datetime.datetime(2019, 5, 13, 5, 10),
                    datetime.datetime(2019, 5, 13, 5, 15),
                    datetime.datetime(2019, 5, 13, 5, 20),
                    datetime.datetime(2019, 5, 13, 5, 25),
                    datetime.datetime(2019, 5, 13, 5, 30),
                ],
                [
                    datetime.datetime(2019, 1, 27, 14, 0),
                    datetime.datetime(2019, 1, 27, 14, 5),
                    datetime.datetime(2019, 1, 27, 14, 10),
                    datetime.datetime(2019, 1, 27, 14, 15),
                    datetime.datetime(2019, 1, 27, 14, 20),
                    datetime.datetime(2019, 1, 27, 14, 25),
                    datetime.datetime(2019, 1, 27, 14, 30),
                    datetime.datetime(2019, 1, 27, 14, 35),
                    datetime.datetime(2019, 1, 27, 14, 40),
                    datetime.datetime(2019, 1, 27, 14, 45),
                    datetime.datetime(2019, 1, 27, 14, 50),
                    datetime.datetime(2019, 1, 27, 14, 55),
                    datetime.datetime(2019, 1, 27, 15, 0),
                    datetime.datetime(2019, 1, 27, 15, 5),
                    datetime.datetime(2019, 1, 27, 15, 10),
                    datetime.datetime(2019, 1, 27, 15, 15),
                    datetime.datetime(2019, 1, 27, 15, 20),
                    datetime.datetime(2019, 1, 27, 15, 25),
                    datetime.datetime(2019, 1, 27, 15, 30),
                ],
            ],
            "coords": {
                "example": {
                    "dims": ("example",),
                    "attrs": {},
                    "data": [
                        0,
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7,
                        8,
                        9,
                        10,
                        11,
                        12,
                        13,
                        14,
                        15,
                        16,
                        17,
                        18,
                        19,
                        20,
                        21,
                        22,
                        23,
                        24,
                        25,
                        26,
                        27,
                        28,
                        29,
                        30,
                        31,
                    ],
                },
                "init_time": {
                    "dims": ("example",),
                    "attrs": {
                        "long_name": "initial time of forecast",
                        "standard_name": "forecast_reference_time",
                    },
                    "data": [
                        datetime.datetime(2019, 3, 26, 15, 0),
                        datetime.datetime(2019, 4, 1, 9, 0),
                        datetime.datetime(2019, 5, 13, 3, 0),
                        datetime.datetime(2019, 1, 27, 12, 0),
                        datetime.datetime(2019, 3, 26, 15, 0),
                        datetime.datetime(2019, 4, 1, 9, 0),
                        datetime.datetime(2019, 5, 13, 3, 0),
                        datetime.datetime(2019, 1, 27, 12, 0),
                        datetime.datetime(2019, 3, 26, 15, 0),
                        datetime.datetime(2019, 4, 1, 9, 0),
                        datetime.datetime(2019, 5, 13, 3, 0),
                        datetime.datetime(2019, 1, 27, 12, 0),
                        datetime.datetime(2019, 3, 26, 15, 0),
                        datetime.datetime(2019, 4, 1, 9, 0),
                        datetime.datetime(2019, 5, 13, 3, 0),
                        datetime.datetime(2019, 1, 27, 12, 0),
                        datetime.datetime(2019, 3, 26, 15, 0),
                        datetime.datetime(2019, 4, 1, 9, 0),
                        datetime.datetime(2019, 5, 13, 3, 0),
                        datetime.datetime(2019, 1, 27, 12, 0),
                        datetime.datetime(2019, 3, 26, 15, 0),
                        datetime.datetime(2019, 4, 1, 9, 0),
                        datetime.datetime(2019, 5, 13, 3, 0),
                        datetime.datetime(2019, 1, 27, 12, 0),
                        datetime.datetime(2019, 3, 26, 15, 0),
                        datetime.datetime(2019, 4, 1, 9, 0),
                        datetime.datetime(2019, 5, 13, 3, 0),
                        datetime.datetime(2019, 1, 27, 12, 0),
                        datetime.datetime(2019, 3, 26, 15, 0),
                        datetime.datetime(2019, 4, 1, 9, 0),
                        datetime.datetime(2019, 5, 13, 3, 0),
                        datetime.datetime(2019, 1, 27, 12, 0),
                    ],
                },
                "time": {
                    "dims": ("time",),
                    "attrs": {},
                    "data": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],
                },
            },
            "name": "nwp_time_coords",
        }
    )
    nwp = xr.DataArray.from_dict(
        {
            "dims": ("example", "nwp_variable", "time", "nwp_y", "nwp_x"),
            "attrs": {},
            "dtype": "float32",
            "shape": (32, 10, 19, 2, 2),
            "data": np.random.random((32, 10, 19, 2, 2)),
            "coords": {
                "example": {
                    "dims": ("example",),
                    "attrs": {},
                    "dtype": "int32",
                    "shape": (32,),
                    "data": list(range(32)),
                },
                "init_time": {
                    "dims": ("example",),
                    "attrs": {
                        "long_name": "initial time of forecast",
                        "standard_name": "forecast_reference_time",
                    },
                    "dtype": "int32",
                    "shape": (32,),
                    "data": list(range(32)),
                },
                "nwp_variable": {
                    "dims": ("nwp_variable",),
                    "attrs": {},
                    "dtype": "object",
                    "shape": (10,),
                    "data": ["o", "c", "f", "i", "s", "co", "ol", "!", ":", ")"],
                },
                "nwp_x": {
                    "dims": ("nwp_x",),
                    "attrs": {},
                    "dtype": "int32",
                    "shape": (2,),
                    "data": [0, 1],
                },
                "nwp_y": {
                    "dims": ("nwp_y",),
                    "attrs": {},
                    "dtype": "int32",
                    "shape": (2,),
                    "data": [0, 1],
                },
                "time": {
                    "dims": ("time",),
                    "attrs": {},
                    "dtype": "int64",
                    "shape": (19,),
                    "data": list(range(19)),
                },
            },
            "name": "nwp",
        }
    )

    x = example.Example(
        sat_data=sat_data, nwp=nwp, nwp_target_time=nwp_time, sat_datetime_index=date_time
    )

    batch = subselect_data(
        x,
        required_keys=(NWP_DATA, NWP_TARGET_TIME, SATELLITE_DATA, SATELLITE_DATETIME_INDEX),
        current_timestep_index=7,
        history_minutes=10,
        forecast_minutes=10,
    )

    assert batch[SATELLITE_DATA].shape[1] == 5
    assert batch[NWP_DATA].shape[2] == 5


@pytest.mark.skip("CD does not have access to GCS")
def test_get_dataloaders_gcp():
    DATA_PATH = "gs://solar-pv-nowcasting-data/prepared_ML_training_data/v5/"
    TEMP_PATH = "../nowcasting_dataset"

    train_dataset = NetCDFDataset(
        24_900, os.path.join(DATA_PATH, "train"), os.path.join(TEMP_PATH, "train")
    )

    dataloader_config = dict(
        pin_memory=True,
        num_workers=2,
        prefetch_factor=8,
        worker_init_fn=worker_init_fn,
        persistent_workers=True,
        # Disable automatic batching because dataset
        # returns complete batches.
        batch_size=None,
    )

    _ = torch.utils.data.DataLoader(train_dataset, **dataloader_config)

    train_dataset.per_worker_init(1)
    t = iter(train_dataset)
    data = next(t)

    # image
    z = data[SATELLITE_DATA][0][0][:, :, 0]
    _ = data[GSP_YIELD][0][:, 0]

    _ = pd.to_datetime(data[SATELLITE_DATETIME_INDEX][0, 0], unit="s")

    fig = go.Figure(data=go.Contour(z=z))

    plotly.offline.plot(fig, filename="../filename.html", auto_open=True)


@pytest.mark.skip("CD does not have access to AWS")
def test_get_dataloaders_aws():

    with tempfile.TemporaryDirectory() as tmpdirname:
        TEMP_PATH = Path(tmpdirname)
        DATA_PATH = "prepared_ML_training_data/v4/"

        os.mkdir(os.path.join(TEMP_PATH, "train"))

        train_dataset = NetCDFDataset(
            24_900, os.path.join(DATA_PATH, "train"), os.path.join(TEMP_PATH, "train"), cloud="aws"
        )

        dataloader_config = dict(
            pin_memory=True,
            num_workers=2,
            prefetch_factor=8,
            worker_init_fn=worker_init_fn,
            persistent_workers=True,
            # Disable automatic batching because dataset
            # returns complete batches.
            batch_size=None,
        )

        _ = torch.utils.data.DataLoader(train_dataset, **dataloader_config)

        train_dataset.per_worker_init(1)
        t = iter(train_dataset)
        data = next(t)

        assert SATELLITE_DATA in data.keys()


@pytest.mark.skip("CD does not have access to GCP")
def test_required_keys_gcp():

    DATA_PATH = "gs://solar-pv-nowcasting-data/prepared_ML_training_data/v5/"
    TEMP_PATH = "../nowcasting_dataset"
    if os.path.isdir(os.path.join(TEMP_PATH, "train")):
        os.removedirs(os.path.join(TEMP_PATH, "train"))
    os.mkdir(os.path.join(TEMP_PATH, "train"))

    train_dataset = NetCDFDataset(
        24_900,
        os.path.join(DATA_PATH, "train"),
        os.path.join(TEMP_PATH, "train"),
        cloud="gcp",
        required_keys=[
            NWP_DATA,
            NWP_X_COORDS,
            NWP_Y_COORDS,
            SATELLITE_DATA,
            SATELLITE_X_COORDS,
            SATELLITE_Y_COORDS,
        ],
    )

    dataloader_config = dict(
        pin_memory=True,
        num_workers=2,
        prefetch_factor=8,
        worker_init_fn=worker_init_fn,
        persistent_workers=True,
        # Disable automatic batching because dataset
        # returns complete batches.
        batch_size=None,
    )

    _ = torch.utils.data.DataLoader(train_dataset, **dataloader_config)

    train_dataset.per_worker_init(1)
    t = iter(train_dataset)
    data = next(t)

    assert SATELLITE_DATA in data.keys()
    assert PV_YIELD not in data.keys()


# @pytest.mark.skip("CD does not have access to GCP")
def test_subsetting_gcp():

    DATA_PATH = "gs://solar-pv-nowcasting-data/prepared_ML_training_data/v5/"
    TEMP_PATH = "../nowcasting_dataset"
    if os.path.isdir(os.path.join(TEMP_PATH, "train")):
        os.removedirs(os.path.join(TEMP_PATH, "train"))
    os.mkdir(os.path.join(TEMP_PATH, "train"))

    train_dataset = NetCDFDataset(
        24_900,
        os.path.join(DATA_PATH, "train"),
        os.path.join(TEMP_PATH, "train"),
        cloud="gcp",
        history_minutes=10,
        forecast_minutes=10,
        current_timestep_index=7,
    )

    dataloader_config = dict(
        pin_memory=True,
        num_workers=2,
        prefetch_factor=8,
        worker_init_fn=worker_init_fn,
        persistent_workers=True,
        # Disable automatic batching because dataset
        # returns complete batches.
        batch_size=None,
    )

    _ = torch.utils.data.DataLoader(train_dataset, **dataloader_config)

    train_dataset.per_worker_init(1)
    t = iter(train_dataset)
    data = next(t)

    sat_data = data[SATELLITE_DATA]

    # Sat is in 5min increments, so should have 2 history + current + 2 future
    assert sat_data.shape[1] == 5
    assert data[NWP_DATA].shape[2] == 5
